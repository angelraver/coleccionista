import{p as Ve,r as Y,c as E,M as Q,N as Ke,O as fe,P as Re,Q as je,l as qe,R as Be,s as W,S as de,T as me,q as l,F as A,U as le,V as Ye,y as we,W as ze,X as be,Y as Ce,Z as He,_ as re,B as D,v as C,w as P,C as N,H as T,x as r,z as ie,L as he,$ as Je,K as Qe,I as We,J as Xe,G as Ze}from"./index-cd28b124.js";import{C as $e}from"./Collection-1bf83a1b.js";import{I as j}from"./Item-de884b8b.js";import{g as et,b as ae,c as ge,V as F,a as k}from"./VResponsive-947568da.js";import{L as oe}from"./Loading-cce37143.js";import{V as tt}from"./VForm-5392997b.js";import{m as lt,u as it,a as at,b as nt,c as rt,d as ot}from"./VSelect-bf367942.js";import{m as st,u as ut,V as ne}from"./VTextField-7d0bee6c.js";import{q as ct,n as dt,p as ve,r as mt,o as X}from"./VBtn-e0d8352e.js";import{f as ft}from"./forwardRefs-e658ad70.js";import{u as ht,V as vt,a as _e}from"./VList-aa305d92.js";import{m as gt,V as yt}from"./VImg-c6111cd0.js";import{V as pt,g as bt,b as Ie}from"./VCard-5746e4a2.js";import{M as xe}from"./ModalConfirm-eaab7058.js";import{V as Ct}from"./VBreadcrumbs-d209908c.js";import"./VOverlay-39fd394b.js";import"./index-5e2249b9.js";import"./ssrBoot-45239230.js";function _t(e){const a=e*1e3;return new Date(a).getFullYear()}const It=async(e,a)=>{try{return await(await et("/games",[e,a+""])).map(m=>({id:m.id,title:m.name,year:_t(m.first_release_date)}))}catch(t){console.error(t)}},Vt={fetch:It},wt={components:{Loading:oe},props:{nameCollection:{type:String,required:!0},idCollection:{type:Number,required:!0},idItemType:{type:Number,required:!0},idPlatform:{type:Number,required:!0},idUser:{type:Number,required:!0}},data(){return{item:{},loading:!1,gameOptionSelected:null,gameTypedString:"",igdbGameList:[],igdbGame:{}}},computed:{isValid(){return!!this.igdbGame.title&&this.igdbGame.title.length>0}},methods:{async create(){this.loading=!0;const e={idcollection:this.idCollection,iditemtype:this.idItemType,iduser:this.idUser,title:this.igdbGame.titleSimple+"",idigdb:this.igdbGame.id,year:this.igdbGame.year};try{await j.create(e),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(a){console.error(a)}finally{this.loading=!1}},async fetchIgdbGames(e){try{const a=await Vt.fetch(e,this.idPlatform);this.igdbGameList=a.map(t=>({id:t.id,title:`${t.title} (${t.year})`,titleSimple:t.title,author:"",year:t.year}))}catch(a){console.error(a)}},async handleGameSelected(e){this.gameOptionSelected=e;const a=this.igdbGameList.find(({id:t})=>t===e);this.igdbGame=a?JSON.parse(JSON.stringify(a,null,2)):{}},async handleGameInput(e){e.data?this.gameTypedString=this.gameTypedString+e.data:this.gameTypedString=this.gameTypedString.substring(0,this.gameTypedString.length-1),this.gameTypedString.length>3&&await this.fetchIgdbGames(this.gameTypedString)},clearGameInput(){this.gameTypedString=""}}};const xt=(e,a,t)=>e==null||a==null?-1:e.toString().toLocaleLowerCase().indexOf(a.toString().toLocaleLowerCase()),kt=Ve({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function St(e,a,t){var y;const m=[],n=(t==null?void 0:t.default)??xt,s=t!=null&&t.filterKeys?fe(t.filterKeys):!1,g=Object.keys((t==null?void 0:t.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return m;e:for(let f=0;f<e.length;f++){const[v,w=v]=fe(e[f]),c={},o={};let I=-1;if(a&&!(t!=null&&t.noFilter)){if(typeof v=="object"){const z=s||Object.keys(w);for(const M of z){const Z=Re(w,M,w),H=(y=t==null?void 0:t.customKeyFilter)==null?void 0:y[M];if(I=H?H(Z,a,v):n(Z,a,v),I!==-1&&I!==!1)H?c[M]=I:o[M]=I;else if((t==null?void 0:t.filterMode)==="every")continue e}}else I=n(v,a,v),I!==-1&&I!==!1&&(o.title=I);const G=Object.keys(o).length,L=Object.keys(c).length;if(!G&&!L||(t==null?void 0:t.filterMode)==="union"&&L!==g&&!G||(t==null?void 0:t.filterMode)==="intersection"&&(L!==g||!G))continue}m.push({index:f,matches:{...o,...c}})}return m}function Ft(e,a,t,m){const n=Y([]),s=Y(new Map),g=E(()=>m!=null&&m.transform?Q(a).map(f=>[f,m.transform(f)]):Q(a));Ke(()=>{const f=typeof t=="function"?t():Q(t),v=typeof f!="string"&&typeof f!="number"?"":String(f),w=St(g.value,v,{customKeyFilter:{...e.customKeyFilter,...Q(m==null?void 0:m.customKeyFilter)},default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),c=Q(a),o=[],I=new Map;w.forEach(G=>{let{index:L,matches:z}=G;const M=c[L];o.push(M),I.set(M.value,z)}),n.value=o,s.value=I});function y(f){return s.value.get(f.value)}return{filteredItems:n,filteredMatches:s,getMatches:y}}function Tt(e,a,t){if(a==null)return e;if(Array.isArray(a))throw new Error("Multiple matches is not implemented");return typeof a=="number"&&~a?l(A,null,[l("span",{class:"v-autocomplete__unmask"},[e.substr(0,a)]),l("span",{class:"v-autocomplete__mask"},[e.substr(a,t)]),l("span",{class:"v-autocomplete__unmask"},[e.substr(a+t)])]):e}const Lt=Ve({autoSelectFirst:{type:[Boolean,String]},search:String,...kt({filterKeys:["title"]}),...lt(),...je(st({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...gt({transition:!1})},"VAutocomplete"),Mt=qe()({name:"VAutocomplete",props:Lt(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,a){let{slots:t}=a;const{t:m}=Be(),n=Y(),s=W(!1),g=W(!0),y=W(!1),f=Y(),v=Y(),w=de(e,"menu"),c=E({get:()=>w.value,set:i=>{var u;w.value&&!i&&((u=f.value)!=null&&u.Î¨openChildren)||(w.value=i)}}),o=W(-1),I=E(()=>{var i;return(i=n.value)==null?void 0:i.color}),G=E(()=>c.value?e.closeText:e.openText),{items:L,transformIn:z,transformOut:M}=ht(e),{textColorClasses:Z,textColorStyles:H}=ct(I),_=de(e,"search",""),h=de(e,"modelValue",[],i=>z(i===null?[null]:fe(i)),i=>{const u=M(i);return e.multiple?u:u[0]??null}),q=ut(),{filteredItems:se,getMatches:ke}=Ft(e,L,()=>g.value?"":_.value),U=E(()=>e.hideSelected?se.value.filter(i=>!h.value.some(u=>u.value===i.value)):se.value),Se=E(()=>h.value.map(i=>i.props.value)),$=E(()=>{var u;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&_.value===((u=U.value[0])==null?void 0:u.title))&&U.value.length>0&&!g.value&&!y.value}),ue=E(()=>e.hideNoData&&!L.value.length||e.readonly||(q==null?void 0:q.isReadonly.value)),ce=Y(),{onListScroll:Fe,onListKeydown:Te}=it(ce,n);function Le(i){e.openOnClear&&(c.value=!0),_.value=""}function Me(){ue.value||(c.value=!0)}function Ue(i){ue.value||(s.value&&(i.preventDefault(),i.stopPropagation()),c.value=!c.value)}function Ae(i){var B,d,V;if(e.readonly||q!=null&&q.isReadonly.value)return;const u=n.value.selectionStart,p=h.value.length;if((o.value>-1||["Enter","ArrowDown","ArrowUp"].includes(i.key))&&i.preventDefault(),["Enter","ArrowDown"].includes(i.key)&&(c.value=!0),["Escape"].includes(i.key)&&(c.value=!1),$.value&&["Enter","Tab"].includes(i.key)&&O(U.value[0]),i.key==="ArrowDown"&&$.value&&((B=ce.value)==null||B.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(i.key)){if(o.value<0){i.key==="Backspace"&&!_.value&&(o.value=p-1);return}const b=o.value,S=h.value[o.value];S&&!S.props.disabled&&O(S),o.value=b>=p-1?p-2:b}if(i.key==="ArrowLeft"){if(o.value<0&&u>0)return;const b=o.value>-1?o.value-1:p-1;h.value[b]?o.value=b:(o.value=-1,n.value.setSelectionRange((d=_.value)==null?void 0:d.length,(V=_.value)==null?void 0:V.length))}if(i.key==="ArrowRight"){if(o.value<0)return;const b=o.value+1;h.value[b]?o.value=b:(o.value=-1,n.value.setSelectionRange(0,0))}}}function De(i){_.value=i.target.value}function Pe(i){if(be(n.value,":autofill")||be(n.value,":-webkit-autofill")){const u=L.value.find(p=>p.title===i.target.value);u&&O(u)}}function Ge(){var i;s.value&&(g.value=!0,(i=n.value)==null||i.focus())}function Ee(i){s.value=!0,setTimeout(()=>{y.value=!0})}function Ne(i){y.value=!1}function Oe(i){(i==null||i===""&&!e.multiple)&&(h.value=[])}const J=W(!1);function O(i){if(e.multiple){const u=h.value.findIndex(p=>e.valueComparator(p.value,i.value));if(u===-1)h.value=[...h.value,i];else{const p=[...h.value];p.splice(u,1),h.value=p}}else h.value=[i],J.value=!0,_.value=i.title,c.value=!1,g.value=!0,Ce(()=>J.value=!1)}return me(s,(i,u)=>{var p;i!==u&&(i?(J.value=!0,_.value=e.multiple?"":String(((p=h.value.at(-1))==null?void 0:p.props.title)??""),g.value=!0,Ce(()=>J.value=!1)):(!e.multiple&&!_.value?h.value=[]:$.value&&!y.value&&!h.value.some(B=>{let{value:d}=B;return d===U.value[0].value})&&O(U.value[0]),c.value=!1,_.value="",o.value=-1))}),me(_,i=>{!s.value||J.value||(i&&(c.value=!0),g.value=!i)}),me(c,()=>{if(!e.hideSelected&&c.value&&h.value.length){const i=U.value.findIndex(u=>h.value.some(p=>u.value===p.value));He&&window.requestAnimationFrame(()=>{var u;i>=0&&((u=v.value)==null||u.scrollToIndex(i))})}}),dt(()=>{const i=!!(e.chips||t.chip),u=!!(!e.hideNoData||U.value.length||t["prepend-item"]||t["append-item"]||t["no-data"]),p=h.value.length>0,B=ne.filterProps(e);return l(ne,le({ref:n},B,{modelValue:_.value,"onUpdate:modelValue":Oe,focused:s.value,"onUpdate:focused":d=>s.value=d,validationValue:h.externalValue,counterValue:h.value.length,dirty:p,onInput:De,onChange:Pe,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":c.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!t.selection,"v-autocomplete--selecting-index":o.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:p?void 0:e.placeholder,"onClick:clear":Le,"onMousedown:control":Me,onKeydown:Ae}),{...t,default:()=>l(A,null,[l(at,le({ref:f,modelValue:c.value,"onUpdate:modelValue":d=>c.value=d,activator:"parent",contentClass:"v-autocomplete__content",disabled:ue.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Ge},e.menuProps),{default:()=>[u&&l(vt,{ref:ce,selected:Se.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:d=>d.preventDefault(),onKeydown:Te,onFocusin:Ee,onFocusout:Ne,onScrollPassive:Fe,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var d,V,b;return[(d=t["prepend-item"])==null?void 0:d.call(t),!U.value.length&&!e.hideNoData&&(((V=t["no-data"])==null?void 0:V.call(t))??l(_e,{title:m(e.noDataText)},null)),l(nt,{ref:v,renderless:!0,items:U.value},{default:S=>{var pe;let{item:x,index:K,itemRef:R}=S;const ye=le(x.props,{ref:R,key:K,active:$.value&&K===0?!0:void 0,onClick:()=>O(x)});return((pe=t.item)==null?void 0:pe.call(t,{item:x,index:K,props:ye}))??l(_e,ye,{prepend:ee=>{let{isSelected:te}=ee;return l(A,null,[e.multiple&&!e.hideSelected?l(rt,{key:x.value,modelValue:te,ripple:!1,tabindex:"-1"},null):void 0,x.props.prependIcon&&l(ve,{icon:x.props.prependIcon},null)])},title:()=>{var ee,te;return g.value?x.title:Tt(x.title,(ee=ke(x))==null?void 0:ee.title,((te=_.value)==null?void 0:te.length)??0)}})}}),(b=t["append-item"])==null?void 0:b.call(t)]}})]}),h.value.map((d,V)=>{function b(R){R.stopPropagation(),R.preventDefault(),O(d)}const S={"onClick:close":b,onMousedown(R){R.preventDefault(),R.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},x=i?!!t.chip:!!t.selection,K=x?Ye(i?t.chip({item:d,index:V,props:S}):t.selection({item:d,index:V})):void 0;if(!(x&&!K))return l("div",{key:d.value,class:["v-autocomplete__selection",V===o.value&&["v-autocomplete__selection--selected",Z.value]],style:V===o.value?H.value:{}},[i?t.chip?l(mt,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:d.title}}},{default:()=>[K]}):l(ot,le({key:"chip",closable:e.closableChips,size:"small",text:d.title,disabled:d.props.disabled},S),null):K??l("span",{class:"v-autocomplete__selection-text"},[d.title,e.multiple&&V<h.value.length-1&&l("span",{class:"v-autocomplete__selection-comma"},[we(",")])])])})]),"append-inner":function(){var S;for(var d=arguments.length,V=new Array(d),b=0;b<d;b++)V[b]=arguments[b];return l(A,null,[(S=t["append-inner"])==null?void 0:S.call(t,...V),e.menuIcon?l(ve,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:Ue,onClick:ze,"aria-label":m(G.value),title:m(G.value)},null):void 0])}})}),ft({isFocused:s,isPristine:g,menu:c,search:_,filteredItems:se,select:O},n)}}),Ut={key:1},At={class:"text-h4 font-weight-bold"};function Dt(e,a,t,m,n,s){const g=D("Loading");return C(),P(A,null,[n.loading?(C(),N(g,{key:0})):T("",!0),n.loading?T("",!0):(C(),P("div",Ut,[l(ae,null,{default:r(()=>[l(ge,{class:"text-center"},{default:r(()=>[l(F,{class:"d-flex align-center justify-center"},{default:r(()=>[l(k,null,{default:r(()=>[l(tt,null,{default:r(()=>[ie("h2",At,"Agregar un Videojuego a la colecciÃ³n "+he(t.nameCollection),1),l(ae,null,{default:r(()=>[l(F,{justify:"center"},{default:r(()=>[l(k,{cols:"8"},{default:r(()=>[l(Mt,{label:"Buscar un tÃ­tulo",modelValue:n.gameOptionSelected,"onUpdate:modelValue":[a[0]||(a[0]=y=>n.gameOptionSelected=y),s.handleGameSelected],items:n.igdbGameList,variant:"outlined","item-text":"title","item-value":"id",onInput:s.handleGameInput,onBlur:s.clearGameInput},null,8,["modelValue","items","onUpdate:modelValue","onInput","onBlur"])]),_:1})]),_:1}),l(F,{justify:"center"},{default:r(()=>[l(k,{cols:"auto"},{default:r(()=>[l(X,{class:"ma-2",text:"Cancelar",onClick:a[1]||(a[1]=y=>e.$router.push({name:"CollectionDetail",params:{id:t.idCollection}}))}),l(X,{disabled:!s.isValid,class:"bg-amber ma-2",text:"Guardar",onClick:a[2]||(a[2]=y=>s.create())},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))],64)}const Pt=re(wt,[["render",Dt]]),Gt={props:{idUser:{type:Number,required:!0},idItem:{type:Number,required:!0}},components:{ModalConfirm:xe,Loading:oe},data(){return{images:[],loading:!1,mediaUrl:Je}},methods:{async fetchItemImages(){this.loading=!0;try{this.images=await j.fetchImages(this.idUser,this.idItem)}catch(e){console.error(e)}finally{this.loading=!1}},async del(e){this.loading=!0;try{await j.removeImage(e.name,e.id,this.idUser)}catch(a){console.error(a)}finally{await this.fetchItemImages(),this.loading=!1}}},async mounted(){await this.fetchItemImages()}},Et={key:1};function Nt(e,a,t,m,n,s){const g=D("Loading"),y=D("ModalConfirm");return C(),P(A,null,[n.loading?(C(),N(g,{key:0})):T("",!0),n.loading?T("",!0):(C(),P("div",Et,[l(ae,null,{default:r(()=>[l(ge,{class:"text-center"},{default:r(()=>[l(F,{class:"justify-center"},{default:r(()=>[l(k,{cols:"8"},{default:r(()=>[l(X,{onClick:a[0]||(a[0]=f=>e.$router.push({name:"Photo",params:{idItem:t.idItem}})),class:"bg-amber mt-2"},{default:r(()=>[l(ve,{icon:"mdi-camera",size:"large",start:""}),we(" Agregar Foto ")]),_:1})]),_:1})]),_:1}),l(F,{class:"justify-center"},{default:r(()=>[l(k,{cols:"auto"},{default:r(()=>[(C(!0),P(A,null,Qe(n.images,(f,v)=>(C(),N(pt,{key:v,class:"pa-2 ma-2"},{default:r(()=>[l(yt,{width:400,src:`${n.mediaUrl}/${f.name}`},null,8,["src"]),l(y,{buttonOpenText:"",buttonOkText:"Eliminar",buttonKoText:"Cancelar",title:"Confirma que deseas eliminar",description:"La imagen serÃ¡ eliminada definitivamente.","button-bg":"bg-red",icon:"mdi-delete",onAgree:w=>s.del(f)},null,8,["onAgree"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]))],64)}const Ot=re(Gt,[["render",Nt]]),Kt={props:{id:{type:Number,required:!1},currentTitle:{type:String,required:!1},currentAuthor:{type:String,required:!1},currentYear:{type:Number,required:!1},nameCollection:{type:String,required:!0},idCollection:{type:Number,required:!0},idItemType:{type:Number,required:!0},idUser:{type:Number,required:!0}},components:{ModalConfirm:xe,ItemImageEdit:Ot,Loading:oe},data(){return{loading:!1,valid:!1,pageTitle:"",title:this.currentTitle||"",author:this.currentAuthor||"",year:this.currentYear||0,typeLabel:e=>bt(e)}},methods:{save(){this.id?this.update():this.create()},async create(){this.loading=!0;try{const e={idcollection:this.idCollection,iditemtype:this.idItemType,iduser:this.idUser,title:this.title,author:this.author,year:this.year},a=await j.create(e);this.$emit("refreshTrigger",a),this.$router.push({name:"ItemEdit",params:{id:a}})}catch(e){console.error(e)}finally{this.loading=!1}},async update(){this.loading=!0;try{await j.update(this.id||0,this.idUser,this.title,this.author,this.year),this.$router.push({name:"ItemDetail",params:{id:this.id}})}catch(e){console.error(e)}finally{this.loading=!1}},async del(){this.loading=!0;try{await j.remove(this.id||0,this.idUser),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(e){console.error(e)}finally{this.loading=!1}},cancel(){this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}},computed:{idValid(){return!!this.title&&this.title.length>0}},watch:{currentTitle:{immediate:!0,handler(e){this.title=e}}}},Rt={key:1},jt={class:"text-h4 font-weight-bold text-center"};function qt(e,a,t,m,n,s){const g=D("Loading"),y=D("ItemImageEdit"),f=D("ModalConfirm");return C(),P(A,null,[n.loading?(C(),N(g,{key:0})):T("",!0),n.loading?T("",!0):(C(),P("div",Rt,[l(ae,null,{default:r(()=>[l(ge,{class:"text-center"},{default:r(()=>[l(F,{justify:"center"},{default:r(()=>[l(k,{cols:"18"},{default:r(()=>[ie("h1",jt,he(t.id?"Editar":"Agregar nuevo item a "+t.nameCollection),1)]),_:1})]),_:1}),l(F,{justify:"center"},{default:r(()=>[l(k,{cols:"8"},{default:r(()=>[l(ne,{modelValue:n.title,"onUpdate:modelValue":a[0]||(a[0]=v=>n.title=v),label:"TÃ­tulo",required:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),l(F,{justify:"center"},{default:r(()=>[l(k,{cols:"8"},{default:r(()=>[l(ne,{modelValue:n.author,"onUpdate:modelValue":a[1]||(a[1]=v=>n.author=v),label:"Autor",required:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),l(F,{class:"justify-center"},{default:r(()=>[l(k,{cols:"8"},{default:r(()=>[ie("p",null,he(n.typeLabel(t.idItemType)),1)]),_:1})]),_:1}),l(F,{class:"justify-center"},{default:r(()=>[l(k,{cols:"8"},{default:r(()=>[t.id?(C(),N(y,{key:0,"id-item":t.id,"id-user":t.idUser},null,8,["id-item","id-user"])):T("",!0)]),_:1})]),_:1}),l(F,{justify:"center"},{default:r(()=>[l(k,{cols:"auto"},{default:r(()=>[We(ie("span",null,[l(f,{buttonOpenText:"Eliminar",buttonOkText:"Eliminar",buttonKoText:"Cancelar",title:"Confirma que deseas eliminar",description:`El item ${n.title} serÃ¡ eliminado de la colecciÃ³n ${t.nameCollection}.`,onAgree:s.del},null,8,["description","onAgree"])],512),[[Xe,t.id]]),l(X,{text:"Cancelar",onClick:a[2]||(a[2]=v=>s.cancel()),class:"ma-2"})]),_:1}),l(k,{cols:"auto"},{default:r(()=>[l(X,{text:"Guardar",onClick:a[3]||(a[3]=v=>s.save()),class:"bg-amber ma-2",disabled:!s.idValid},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]))],64)}const Bt=re(Kt,[["render",qt]]),Yt={components:{ItemFormGame:Pt,ItemForm:Bt,Loading:oe},data(){var e;return{breadcrumbs:[],id:parseInt(this.$route.params.id+""),idCollection:parseInt(this.$route.params.idCollection+""),idUser:parseInt(((e=Ze())==null?void 0:e.id)+""),idItemType:0,idPlatform:0,nameCollection:"",item:{},collection:{},code:"",loading:!1}},methods:{async fetchItem(){this.loading=!0;try{const e=await j.fetch(this.idUser,this.id,null);this.item=e[0],this.idCollection=this.item.idcollection,this.idItemType=this.item.iditemtype,this.nameCollection=this.item.collectionname+"",this.code=Ie(this.item.iditemtype)}catch(e){console.error(e)}finally{this.loading=!1}},async fetchCollection(){this.loading=!0;try{const e=await $e.fetch(this.idUser,this.idCollection);this.collection=e[0],this.idItemType=this.collection.iditemtype,this.nameCollection=this.collection.name,this.idPlatform=this.collection.idplatform,this.code=Ie(this.collection.iditemtype)}catch(e){console.error(e)}finally{this.loading=!1}},async refresh(e){this.id=e,this.fetchItem()}},async mounted(){this.breadcrumbs=[{title:"Colecciones",href:"/home"}],this.idCollection&&(await this.fetchCollection(),this.breadcrumbs=[...this.breadcrumbs,{title:this.collection.name,href:"/collection/"+this.collection.id},{title:"Nuevo"}]),this.id&&(await this.fetchItem(),this.breadcrumbs=[...this.breadcrumbs,{title:this.nameCollection,href:"/collection/"+this.item.idcollection},{title:this.item.title,href:"/item/"+this.item.id},{title:"Editar"}])}},zt={key:1};function Ht(e,a,t,m,n,s){var v,w,c,o;const g=D("Loading"),y=D("ItemFormGame"),f=D("ItemForm",!0);return C(),P(A,null,[n.loading?(C(),N(g,{key:0})):T("",!0),n.loading?T("",!0):(C(),P("div",zt,[l(Ct,{items:n.breadcrumbs},null,8,["items"]),n.code==="videogame"?(C(),N(y,{key:0,"id-collection":n.idCollection,"id-user":n.idUser,"id-item-type":n.idItemType,"id-platform":n.idPlatform,"name-collection":n.nameCollection},null,8,["id-collection","id-user","id-item-type","id-platform","name-collection"])):T("",!0),n.code!=="videogame"?(C(),N(f,{key:1,id:(v=n.item)==null?void 0:v.id,"current-title":(w=n.item)==null?void 0:w.title,"current-author":(c=n.item)==null?void 0:c.author,"current-year":(o=n.item)==null?void 0:o.year,"id-collection":n.idCollection,"id-user":n.idUser,"id-item-type":n.idItemType,"name-collection":n.nameCollection},null,8,["id","current-title","current-author","current-year","id-collection","id-user","id-item-type","name-collection"])):T("",!0)]))],64)}const ml=re(Yt,[["render",Ht]]);export{ml as default};
