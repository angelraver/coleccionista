import{G as v,_ as S,B as V,v as l,w as u,C as p,H as m,q as n,x as a,I as U,J as B,F as g,K as T,z as d,L as _,y as x,A as R,M as w}from"./index-ec70cf82.js";import{C as L}from"./Collection-8c81e015.js";import{g as z,V as A,a as E}from"./VCard-69822ef7.js";import{L as I}from"./Loading-88873d3a.js";import{V as C,a as y,b as $,c as F}from"./VResponsive-e0b54abe.js";import{I as H}from"./Item-470b7969.js";import{p as j,o as D}from"./VBtn-16eb0950.js";import"./VImg-258f04ad.js";const M="/assets/logo-xs-cdcd7678.png",O={components:{Loading:I},data(){var t;return{loading:!1,idUser:parseInt(((t=v())==null?void 0:t.id)+""),collections:[],typeLabel:e=>z(e)}},methods:{async fetchCollections(){this.loading=!0;try{const t=await L.fetch(this.idUser,null);this.collections=t}catch(t){console.error(t)}finally{this.loading=!1}}},async mounted(){this.collections=[],await this.fetchCollections()}},q={key:1},J=d("p",null,"No hay colecciones.",-1),G={class:"text-h6 pa-1"},K={class:"text-caption"},Y={class:"text-caption"};function P(t,e,i,s,o,c){const r=V("Loading");return l(),u(g,null,[o.loading?(l(),p(r,{key:0})):m("",!0),o.loading?m("",!0):(l(),u("div",q,[n($,{fluid:"","fill-height":""},{default:a(()=>{var f;return[U(n(C,{justify:"center"},{default:a(()=>[n(y,{cols:"auto"},{default:a(()=>[J]),_:1})]),_:1},512),[[B,((f=o.collections)==null?void 0:f.length)<1]]),o.collections.length>0?(l(),p(C,{key:0,justify:"center"},{default:a(()=>[(l(!0),u(g,null,T(o.collections,(h,N)=>(l(),p(y,{key:N,cols:"auto"},{default:a(()=>[n(A,{class:"mx-auto",width:"200",height:"100",onClick:nt=>t.$router.push({name:"CollectionDetail",params:{id:h.id}})},{default:a(()=>[n(E,null,{default:a(()=>[d("div",G,_(h.name),1),d("div",K,_(o.typeLabel(h.iditemtype)),1),d("div",Y,_(h.itemscount)+" ítems",1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):m("",!0)]}),_:1})]))],64)}const Q=S(O,[["render",P]]);var k=(t=>(t.Users="Users",t.Collections="Collections",t.Items="Items",t))(k||{});const W={components:{Loading:I},props:{option:{type:String,required:!0}},data(){var t;return{loading:!1,idUser:parseInt(((t=v())==null?void 0:t.id)+"")}},methods:{getCurrentDateTime(){const t=new Date,e=t.getDate().toString().padStart(2,"0"),i=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getFullYear().toString(),o=t.getHours().toString().padStart(2,"0"),c=t.getMinutes().toString().padStart(2,"0"),r=t.getSeconds().toString().padStart(2,"0");return e+i+s+o+c+r},async downloadBackup(){this.loading=!0;try{let t;switch(this.$props.option){case"Items":t=await H.backup();break;case"Collections":t=await L.backup();break;default:return null}const e=this.jsonToCSV(t);this.downloadCSV(e,this.$props.option+this.getCurrentDateTime()+".csv")}catch(t){console.error(t)}finally{this.loading=!1}},jsonToCSV(t,e=","){const i=(c,r)=>r===null?"":r,s=Object.keys(t[0]),o=t.map(c=>s.map(r=>JSON.stringify(c[r],i)).join(e));return o.unshift(s.join(e)),o.join(`\r
`)},downloadCSV(t,e="data.csv"){const i=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),o=URL.createObjectURL(i);s.setAttribute("href",o),s.setAttribute("download",e),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}}},X={key:1};function Z(t,e,i,s,o,c){const r=V("Loading");return l(),u(g,null,[o.loading?(l(),p(r,{key:0})):m("",!0),o.loading?m("",!0):(l(),u("div",X,[n(D,{onClick:e[0]||(e[0]=f=>c.downloadBackup())},{default:a(()=>[n(j,{icon:"mdi-file-download",size:"large",start:""}),x(" "+_(i.option)+" backup ",1)]),_:1})]))],64)}const b=S(W,[["render",Z]]),tt=d("img",{src:M,title:"Coleccionista"},null,-1),et=d("h1",null,"Tus colecciones",-1),ot=d("br",null,null,-1),pt=R({__name:"Home",setup(t){return(e,i)=>(l(),p($,null,{default:a(()=>[n(F,{class:"text-center"},{default:a(()=>[n(C,{class:"d-flex align-center justify-center"},{default:a(()=>[n(y,{cols:"auto"},{default:a(()=>[tt,et,n(D,{onClick:i[0]||(i[0]=s=>e.$router.push({name:"CollectionNew"})),class:"bg-amber mt-4"},{default:a(()=>[n(j,{icon:"mdi-plus",size:"large",start:""}),x(" Nueva Colección ")]),_:1}),n(Q),n(b,{option:w(k).Items},null,8,["option"]),ot,n(b,{option:w(k).Collections},null,8,["option"])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{pt as default};
