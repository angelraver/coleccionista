import{p as _e,r as j,c as D,L as H,M as Oe,N as me,O as je,P as Ke,l as Be,Q as Re,s as J,R as se,S as ce,q as l,I as Q,T as ie,U as Ye,y as ze,V as He,W as ye,X as pe,Y as Je,_ as ne,v as P,w as K,x as r,z as E,K as X,B as W,F as Ie,G as Ve,E as Qe,H as We,Z as de}from"./index-38bd3cc0.js";import{C as Xe}from"./Collection-9f4c18f6.js";import{I as U}from"./Item-b70f44d3.js";import{g as Ze,m as $e,b as ae,V,a as x,c as fe}from"./VRow-0bee3a9c.js";import{V as et}from"./VForm-aead25db.js";import{m as tt,u as lt,a as it,b as at,c as nt,d as rt}from"./VSelect-24d3330a.js";import{m as ot,u as ut,V as Z}from"./VTextField-24fd4d0b.js";import{q as st,n as ct,p as ge,r as dt,o as B}from"./VBtn-f5dd6058.js";import{f as mt}from"./forwardRefs-e658ad70.js";import{u as ft,V as ht,a as Ce}from"./VList-edca5a6f.js";import{g as xe,a as be}from"./VAvatar-d2c1006d.js";import{M as we}from"./ModalConfirm-34bb19ed.js";import{V as vt}from"./VBreadcrumbs-57113652.js";import"./index-7114f3be.js";import"./ssrBoot-c5e65d15.js";import"./VCard-cfba551d.js";function yt(e){const a=e*1e3;return new Date(a).getFullYear()}const pt=async(e,a)=>{try{return await(await Ze("/games",[e,a+""])).map(m=>({id:m.id,title:m.name,year:yt(m.first_release_date)}))}catch(t){console.error(t)}},gt={fetch:pt},Ct={props:{nameCollection:{type:String,required:!0},idCollection:{type:Number,required:!0},idItemType:{type:Number,required:!0},idPlatform:{type:Number,required:!0},idUser:{type:Number,required:!0}},data(){return{item:{},loading:!1,gameOptionSelected:null,gameTypedString:"",igdbGameList:[],igdbGame:{}}},computed:{isValid(){return!!this.igdbGame.title&&this.igdbGame.title.length>0}},methods:{async create(){this.loading=!0;const e={idcollection:this.idCollection,iditemtype:this.idItemType,iduser:this.idUser,title:this.igdbGame.titleSimple+"",idigdb:this.igdbGame.id,year:this.igdbGame.year};try{await U.create(e),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(a){console.error(a)}finally{this.loading=!1}},async fetchIgdbGames(e){this.loading=!0;try{const a=await gt.fetch(e,this.idPlatform);this.igdbGameList=a.map(t=>({id:t.id,title:`${t.title} (${t.year})`,titleSimple:t.title,author:"",year:t.year}))}catch(a){console.error(a)}finally{this.loading=!1}},async handleGameSelected(e){this.gameOptionSelected=e;const a=this.igdbGameList.find(({id:t})=>t===e);this.igdbGame=a?JSON.parse(JSON.stringify(a,null,2)):{}},async handleGameInput(e){e.data?this.gameTypedString=this.gameTypedString+e.data:this.gameTypedString=this.gameTypedString.substring(0,this.gameTypedString.length-1),this.gameTypedString.length>3&&await this.fetchIgdbGames(this.gameTypedString)},clearGameInput(){this.gameTypedString=""}}};const bt=(e,a,t)=>e==null||a==null?-1:e.toString().toLocaleLowerCase().indexOf(a.toString().toLocaleLowerCase()),_t=_e({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function It(e,a,t){var v;const m=[],n=(t==null?void 0:t.default)??bt,o=t!=null&&t.filterKeys?me(t.filterKeys):!1,f=Object.keys((t==null?void 0:t.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return m;e:for(let p=0;p<e.length;p++){const[_,w=_]=me(e[p]),c={},u={};let C=-1;if(a&&!(t!=null&&t.noFilter)){if(typeof _=="object"){const R=o||Object.keys(w);for(const M of R){const $=je(w,M,w),Y=(v=t==null?void 0:t.customKeyFilter)==null?void 0:v[M];if(C=Y?Y($,a,_):n($,a,_),C!==-1&&C!==!1)Y?c[M]=C:u[M]=C;else if((t==null?void 0:t.filterMode)==="every")continue e}}else C=n(_,a,_),C!==-1&&C!==!1&&(u.title=C);const k=Object.keys(u).length,T=Object.keys(c).length;if(!k&&!T||(t==null?void 0:t.filterMode)==="union"&&T!==f&&!k||(t==null?void 0:t.filterMode)==="intersection"&&(T!==f||!k))continue}m.push({index:p,matches:{...u,...c}})}return m}function Vt(e,a,t,m){const n=j([]),o=j(new Map),f=D(()=>m!=null&&m.transform?H(a).map(p=>[p,m.transform(p)]):H(a));Oe(()=>{const p=typeof t=="function"?t():H(t),_=typeof p!="string"&&typeof p!="number"?"":String(p),w=It(f.value,_,{customKeyFilter:{...e.customKeyFilter,...H(m==null?void 0:m.customKeyFilter)},default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),c=H(a),u=[],C=new Map;w.forEach(k=>{let{index:T,matches:R}=k;const M=c[T];u.push(M),C.set(M.value,R)}),n.value=u,o.value=C});function v(p){return o.value.get(p.value)}return{filteredItems:n,filteredMatches:o,getMatches:v}}function xt(e,a,t){if(a==null)return e;if(Array.isArray(a))throw new Error("Multiple matches is not implemented");return typeof a=="number"&&~a?l(Q,null,[l("span",{class:"v-autocomplete__unmask"},[e.substr(0,a)]),l("span",{class:"v-autocomplete__mask"},[e.substr(a,t)]),l("span",{class:"v-autocomplete__unmask"},[e.substr(a+t)])]):e}const wt=_e({autoSelectFirst:{type:[Boolean,String]},search:String,..._t({filterKeys:["title"]}),...tt(),...Ke(ot({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...$e({transition:!1})},"VAutocomplete"),St=Be()({name:"VAutocomplete",props:wt(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,a){let{slots:t}=a;const{t:m}=Re(),n=j(),o=J(!1),f=J(!0),v=J(!1),p=j(),_=j(),w=se(e,"menu"),c=D({get:()=>w.value,set:i=>{var s;w.value&&!i&&((s=p.value)!=null&&s.ΨopenChildren)||(w.value=i)}}),u=J(-1),C=D(()=>{var i;return(i=n.value)==null?void 0:i.color}),k=D(()=>c.value?e.closeText:e.openText),{items:T,transformIn:R,transformOut:M}=ft(e),{textColorClasses:$,textColorStyles:Y}=st(C),b=se(e,"search",""),h=se(e,"modelValue",[],i=>R(i===null?[null]:me(i)),i=>{const s=M(i);return e.multiple?s:s[0]??null}),q=ut(),{filteredItems:re,getMatches:Se}=Vt(e,T,()=>f.value?"":b.value),A=D(()=>e.hideSelected?re.value.filter(i=>!h.value.some(s=>s.value===i.value)):re.value),ke=D(()=>h.value.map(i=>i.props.value)),ee=D(()=>{var s;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&b.value===((s=A.value[0])==null?void 0:s.title))&&A.value.length>0&&!f.value&&!v.value}),oe=D(()=>e.hideNoData&&!T.value.length||e.readonly||(q==null?void 0:q.isReadonly.value)),ue=j(),{onListScroll:Fe,onListKeydown:Te}=lt(ue,n);function Me(i){e.openOnClear&&(c.value=!0),b.value=""}function Ae(){oe.value||(c.value=!0)}function De(i){oe.value||(o.value&&(i.preventDefault(),i.stopPropagation()),c.value=!c.value)}function Ue(i){var O,d,I;if(e.readonly||q!=null&&q.isReadonly.value)return;const s=n.value.selectionStart,y=h.value.length;if((u.value>-1||["Enter","ArrowDown","ArrowUp"].includes(i.key))&&i.preventDefault(),["Enter","ArrowDown"].includes(i.key)&&(c.value=!0),["Escape"].includes(i.key)&&(c.value=!1),ee.value&&["Enter","Tab"].includes(i.key)&&G(A.value[0]),i.key==="ArrowDown"&&ee.value&&((O=ue.value)==null||O.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(i.key)){if(u.value<0){i.key==="Backspace"&&!b.value&&(u.value=y-1);return}const g=u.value,F=h.value[u.value];F&&!F.props.disabled&&G(F),u.value=g>=y-1?y-2:g}if(i.key==="ArrowLeft"){if(u.value<0&&s>0)return;const g=u.value>-1?u.value-1:y-1;h.value[g]?u.value=g:(u.value=-1,n.value.setSelectionRange((d=b.value)==null?void 0:d.length,(I=b.value)==null?void 0:I.length))}if(i.key==="ArrowRight"){if(u.value<0)return;const g=u.value+1;h.value[g]?u.value=g:(u.value=-1,n.value.setSelectionRange(0,0))}}}function Ge(i){b.value=i.target.value}function Le(i){if(ye(n.value,":autofill")||ye(n.value,":-webkit-autofill")){const s=T.value.find(y=>y.title===i.target.value);s&&G(s)}}function Ne(){var i;o.value&&(f.value=!0,(i=n.value)==null||i.focus())}function Pe(i){o.value=!0,setTimeout(()=>{v.value=!0})}function Ee(i){v.value=!1}function qe(i){(i==null||i===""&&!e.multiple)&&(h.value=[])}const z=J(!1);function G(i){if(e.multiple){const s=h.value.findIndex(y=>e.valueComparator(y.value,i.value));if(s===-1)h.value=[...h.value,i];else{const y=[...h.value];y.splice(s,1),h.value=y}}else h.value=[i],z.value=!0,b.value=i.title,c.value=!1,f.value=!0,pe(()=>z.value=!1)}return ce(o,(i,s)=>{var y;i!==s&&(i?(z.value=!0,b.value=e.multiple?"":String(((y=h.value.at(-1))==null?void 0:y.props.title)??""),f.value=!0,pe(()=>z.value=!1)):(!e.multiple&&!b.value?h.value=[]:ee.value&&!v.value&&!h.value.some(O=>{let{value:d}=O;return d===A.value[0].value})&&G(A.value[0]),c.value=!1,b.value="",u.value=-1))}),ce(b,i=>{!o.value||z.value||(i&&(c.value=!0),f.value=!i)}),ce(c,()=>{if(!e.hideSelected&&c.value&&h.value.length){const i=A.value.findIndex(s=>h.value.some(y=>s.value===y.value));Je&&window.requestAnimationFrame(()=>{var s;i>=0&&((s=_.value)==null||s.scrollToIndex(i))})}}),ct(()=>{const i=!!(e.chips||t.chip),s=!!(!e.hideNoData||A.value.length||t["prepend-item"]||t["append-item"]||t["no-data"]),y=h.value.length>0,O=Z.filterProps(e);return l(Z,ie({ref:n},O,{modelValue:b.value,"onUpdate:modelValue":qe,focused:o.value,"onUpdate:focused":d=>o.value=d,validationValue:h.externalValue,counterValue:h.value.length,dirty:y,onInput:Ge,onChange:Le,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":c.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!t.selection,"v-autocomplete--selecting-index":u.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:y?void 0:e.placeholder,"onClick:clear":Me,"onMousedown:control":Ae,onKeydown:Ue}),{...t,default:()=>l(Q,null,[l(it,ie({ref:p,modelValue:c.value,"onUpdate:modelValue":d=>c.value=d,activator:"parent",contentClass:"v-autocomplete__content",disabled:oe.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Ne},e.menuProps),{default:()=>[s&&l(ht,{ref:ue,selected:ke.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:d=>d.preventDefault(),onKeydown:Te,onFocusin:Pe,onFocusout:Ee,onScrollPassive:Fe,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var d,I,g;return[(d=t["prepend-item"])==null?void 0:d.call(t),!A.value.length&&!e.hideNoData&&(((I=t["no-data"])==null?void 0:I.call(t))??l(Ce,{title:m(e.noDataText)},null)),l(at,{ref:_,renderless:!0,items:A.value},{default:F=>{var ve;let{item:S,index:L,itemRef:N}=F;const he=ie(S.props,{ref:N,key:L,active:ee.value&&L===0?!0:void 0,onClick:()=>G(S)});return((ve=t.item)==null?void 0:ve.call(t,{item:S,index:L,props:he}))??l(Ce,he,{prepend:te=>{let{isSelected:le}=te;return l(Q,null,[e.multiple&&!e.hideSelected?l(nt,{key:S.value,modelValue:le,ripple:!1,tabindex:"-1"},null):void 0,S.props.prependIcon&&l(ge,{icon:S.props.prependIcon},null)])},title:()=>{var te,le;return f.value?S.title:xt(S.title,(te=Se(S))==null?void 0:te.title,((le=b.value)==null?void 0:le.length)??0)}})}}),(g=t["append-item"])==null?void 0:g.call(t)]}})]}),h.value.map((d,I)=>{function g(N){N.stopPropagation(),N.preventDefault(),G(d)}const F={"onClick:close":g,onMousedown(N){N.preventDefault(),N.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},S=i?!!t.chip:!!t.selection,L=S?Ye(i?t.chip({item:d,index:I,props:F}):t.selection({item:d,index:I})):void 0;if(!(S&&!L))return l("div",{key:d.value,class:["v-autocomplete__selection",I===u.value&&["v-autocomplete__selection--selected",$.value]],style:I===u.value?Y.value:{}},[i?t.chip?l(dt,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:d.title}}},{default:()=>[L]}):l(rt,ie({key:"chip",closable:e.closableChips,size:"small",text:d.title,disabled:d.props.disabled},F),null):L??l("span",{class:"v-autocomplete__selection-text"},[d.title,e.multiple&&I<h.value.length-1&&l("span",{class:"v-autocomplete__selection-comma"},[ze(",")])])])})]),"append-inner":function(){var F;for(var d=arguments.length,I=new Array(d),g=0;g<d;g++)I[g]=arguments[g];return l(Q,null,[(F=t["append-inner"])==null?void 0:F.call(t,...I),e.menuIcon?l(ge,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:De,onClick:He,"aria-label":m(k.value),title:m(k.value)},null):void 0])}})}),mt({isFocused:o,isPristine:f,menu:c,search:b,filteredItems:re,select:G},n)}}),kt={class:"text-h4 font-weight-bold"};function Ft(e,a,t,m,n,o){return P(),K(ae,null,{default:r(()=>[l(fe,{class:"text-center"},{default:r(()=>[l(V,{class:"d-flex align-center justify-center"},{default:r(()=>[l(x,null,{default:r(()=>[l(et,null,{default:r(()=>[E("h2",kt,"Agregar un Videojuego a la colección "+X(t.nameCollection),1),l(ae,null,{default:r(()=>[l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"8"},{default:r(()=>[l(St,{label:"Buscar un título",modelValue:n.gameOptionSelected,"onUpdate:modelValue":[a[0]||(a[0]=f=>n.gameOptionSelected=f),o.handleGameSelected],items:n.igdbGameList,variant:"outlined","item-text":"title","item-value":"id",onInput:o.handleGameInput,onBlur:o.clearGameInput},null,8,["modelValue","items","onUpdate:modelValue","onInput","onBlur"])]),_:1})]),_:1}),l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"auto"},{default:r(()=>[l(B,{class:"ma-2",text:"Cancelar",onClick:a[1]||(a[1]=f=>e.$router.push({name:"CollectionDetail",params:{id:t.idCollection}}))}),l(B,{disabled:!o.isValid,class:"bg-amber ma-2",text:"Guardar",onClick:a[2]||(a[2]=f=>o.create())},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Tt=ne(Ct,[["render",Ft]]),Mt={props:{id:{type:Number,required:!1},currentTitle:{type:String,required:!1},nameCollection:{type:String,required:!0},idCollection:{type:Number,required:!0},idItemType:{type:Number,required:!0},idUser:{type:Number,required:!0}},components:{ModalConfirm:we},data(){return{loading:!1,valid:!1,pageTitle:"",title:this.currentTitle||"",typeLabel:e=>xe(e)}},methods:{save(){this.id?this.update():this.create()},async create(){this.loading=!0;try{const e={idcollection:this.idCollection,iditemtype:this.idItemType,iduser:this.idUser,title:this.title};await U.create(e),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(e){console.error(e)}finally{this.loading=!1}},async update(){this.loading=!0;try{await U.update(this.id||0,this.idUser,this.title,"",0),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(e){console.error(e)}finally{this.loading=!1}},async del(){this.loading=!0;try{await U.remove(this.id||0,this.idUser),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(e){console.error(e)}finally{this.loading=!1}},cancel(){this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}},computed:{idValid(){return!!this.title&&this.title.length>0}},watch:{currentTitle:{immediate:!0,handler(e){this.title=e}}}},At={class:"text-h4 font-weight-bold text-center"};function Dt(e,a,t,m,n,o){const f=W("ModalConfirm");return P(),K(ae,null,{default:r(()=>[l(fe,{class:"text-center"},{default:r(()=>[l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"18"},{default:r(()=>[E("h1",At,X(t.id?"Editar":"Agregar nuevo item a "+t.nameCollection),1)]),_:1})]),_:1}),l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"8"},{default:r(()=>[l(Z,{modelValue:n.title,"onUpdate:modelValue":a[0]||(a[0]=v=>n.title=v),label:"Título",required:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),l(V,{class:"justify-center"},{default:r(()=>[l(x,{cols:"8"},{default:r(()=>[E("p",null,X(n.typeLabel(t.idItemType)),1)]),_:1})]),_:1}),l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"auto"},{default:r(()=>[l(B,{text:"Guardar",onClick:a[1]||(a[1]=v=>o.save()),class:"bg-amber ma-2",disabled:!o.idValid},null,8,["disabled"])]),_:1})]),_:1}),l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"auto"},{default:r(()=>[Ie(E("span",null,[l(f,{buttonOpenText:"Eliminar",buttonOkText:"Eliminar",buttonKoText:"Cancelar",title:"Confirma que deseas eliminar",description:`El item ${n.title} será eliminado de la colección ${t.nameCollection}.`,onAgree:o.del},null,8,["description","onAgree"])],512),[[Ve,t.id]]),l(B,{text:"Cancelar",onClick:a[2]||(a[2]=v=>o.cancel()),class:"ma-2"})]),_:1})]),_:1})]),_:1})]),_:1})}const Ut=ne(Mt,[["render",Dt]]),Gt={props:{id:{type:Number,required:!1},currentTitle:{type:String,required:!1},currentAuthor:{type:String,required:!1},currentYear:{type:Number,required:!1},nameCollection:{type:String,required:!0},idCollection:{type:Number,required:!0},idItemType:{type:Number,required:!0},idUser:{type:Number,required:!0}},components:{ModalConfirm:we},data(){return{loading:!1,valid:!1,pageTitle:"",title:this.currentTitle||"",author:this.currentAuthor||"",year:this.currentYear||0,typeLabel:e=>xe(e)}},methods:{save(){this.id?this.update():this.create()},async create(){this.loading=!0;try{const e={idcollection:this.idCollection,iditemtype:this.idItemType,iduser:this.idUser,title:this.title,author:this.author,year:this.year};await U.create(e),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(e){console.error(e)}finally{this.loading=!1}},async update(){this.loading=!0;try{await U.update(this.id||0,this.idUser,this.title,this.author,this.year),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(e){console.error(e)}finally{this.loading=!1}},async del(){this.loading=!0;try{await U.remove(this.id||0,this.idUser),this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}catch(e){console.error(e)}finally{this.loading=!1}},cancel(){this.$router.push({name:"CollectionDetail",params:{id:this.idCollection}})}},computed:{idValid(){return!!this.title&&this.title.length>0}},watch:{currentTitle:{immediate:!0,handler(e){this.title=e}}}},Lt={class:"text-h4 font-weight-bold text-center"};function Nt(e,a,t,m,n,o){const f=W("ModalConfirm");return P(),K(ae,null,{default:r(()=>[l(fe,{class:"text-center"},{default:r(()=>[l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"18"},{default:r(()=>[E("h1",Lt,X(t.id?"Editar":"Agregar nuevo item a "+t.nameCollection),1)]),_:1})]),_:1}),l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"8"},{default:r(()=>[l(Z,{modelValue:n.title,"onUpdate:modelValue":a[0]||(a[0]=v=>n.title=v),label:"Título",required:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"8"},{default:r(()=>[l(Z,{modelValue:n.author,"onUpdate:modelValue":a[1]||(a[1]=v=>n.author=v),label:"Autor",required:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),l(V,{class:"justify-center"},{default:r(()=>[l(x,{cols:"8"},{default:r(()=>[E("p",null,X(n.typeLabel(t.idItemType)),1)]),_:1})]),_:1}),l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"auto"},{default:r(()=>[l(B,{text:"Guardar",onClick:a[2]||(a[2]=v=>o.save()),class:"bg-amber ma-2",disabled:!o.idValid},null,8,["disabled"])]),_:1})]),_:1}),l(V,{justify:"center"},{default:r(()=>[l(x,{cols:"auto"},{default:r(()=>[Ie(E("span",null,[l(f,{buttonOpenText:"Eliminar",buttonOkText:"Eliminar",buttonKoText:"Cancelar",title:"Confirma que deseas eliminar",description:`El item ${n.title} será eliminado de la colección ${t.nameCollection}.`,onAgree:o.del},null,8,["description","onAgree"])],512),[[Ve,t.id]]),l(B,{text:"Cancelar",onClick:a[3]||(a[3]=v=>o.cancel()),class:"ma-2"})]),_:1})]),_:1})]),_:1})]),_:1})}const Pt=ne(Gt,[["render",Nt]]),Et={components:{ItemFormGame:Tt,ItemFormAny:Ut,ItemFormBook:Pt},data(){var e;return{breadcrumb:[],id:parseInt(this.$route.params.id+""),idCollection:parseInt(this.$route.params.idCollection+""),idUser:parseInt(((e=Qe())==null?void 0:e.id)+""),idItemType:0,idPlatform:0,nameCollection:"",item:{},collection:{},code:"",loading:!1}},methods:{async fetchItem(){this.loading=!0;try{const e=await U.fetch(this.idUser,this.id,null);this.item=e[0],this.idCollection=this.item.idcollection,this.idItemType=this.item.iditemtype,this.nameCollection=this.item.collectionname+"",this.code=be(this.item.iditemtype)}catch(e){console.error(e)}finally{this.loading=!1}},async fetchCollection(){this.loading=!0;try{const e=await Xe.fetch(this.idUser,this.idCollection);this.collection=e[0],this.idItemType=this.collection.iditemtype,this.nameCollection=this.collection.name,this.idPlatform=this.collection.idplatform,this.code=be(this.collection.iditemtype)}catch(e){console.error(e)}finally{this.loading=!1}}},async mounted(){this.idCollection&&(await this.fetchCollection(),this.breadcrumb=["Colecciones",this.collection.name,"Item","Nuevo"]),this.id&&(await this.fetchItem(),this.breadcrumb=["Colecciones",this.nameCollection+"",this.item.title,"Editar"])}};function qt(e,a,t,m,n,o){var _,w,c,u,C,k;const f=W("ItemFormGame"),v=W("ItemFormBook"),p=W("ItemFormAny");return P(),We(Q,null,[l(vt,{items:n.breadcrumb},null,8,["items"]),n.code==="videogame"?(P(),K(f,{key:0,"id-collection":n.idCollection,"id-user":n.idUser,"id-item-type":n.idItemType,"id-platform":n.idPlatform,"name-collection":n.nameCollection},null,8,["id-collection","id-user","id-item-type","id-platform","name-collection"])):de("",!0),n.code==="book"?(P(),K(v,{key:1,id:(_=n.item)==null?void 0:_.id,"current-title":(w=n.item)==null?void 0:w.title,"current-author":(c=n.item)==null?void 0:c.author,"current-year":(u=n.item)==null?void 0:u.year,"id-collection":n.idCollection,"id-user":n.idUser,"id-item-type":n.idItemType,"name-collection":n.nameCollection},null,8,["id","current-title","current-author","current-year","id-collection","id-user","id-item-type","name-collection"])):de("",!0),n.code!=="videogame"&&n.code!=="book"?(P(),K(p,{key:2,id:(C=n.item)==null?void 0:C.id,"current-title":(k=n.item)==null?void 0:k.title,"id-collection":n.idCollection,"id-user":n.idUser,"id-item-type":n.idItemType,"name-collection":n.nameCollection},null,8,["id","current-title","id-collection","id-user","id-item-type","name-collection"])):de("",!0)],64)}const ll=ne(Et,[["render",qt]]);export{ll as default};
