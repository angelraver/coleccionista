import{as as X,at as Z,au as ee,av as te,I as $,aw as ae,ax as se,ay as ne,az as re,ar as oe,aA as ie,al as ce,aB as le,aC as de,aD as ue,aE as fe,aF as me,aG as pe,aH as he,aI as ve,aJ as be,c as ge,aK as ye,w as we,L as _e,H as I,z as Ce,aL as Se,aM as Ee,aN as xe,aO as Re,aP as Ve,aQ as Ie,y as T,q as h,aR as Te,aS as Me,A as ke,aT as Be,aU as De,aV as Ne,aW as Pe,aX as je,aY as $e,aZ as Ue,a_ as Ae,a$ as Oe,b0 as Fe,ap as ze,b1 as He,b2 as qe,b3 as Ke,b4 as Ge,b5 as Le,b6 as We,b7 as Je,b8 as Ye,b9 as Qe,ba as Xe,i as Ze,bb as et,bc as tt,bd as at,be as st,bf as nt,bg as rt,bh as ot,bi as it,bj as ct,bk as lt,bl as dt,U as ut,Y as ft,bm as mt,bn as pt,bo as ht,j as vt,bp as bt,k as gt,bq as yt,h as wt,br as _t,o as Ct,bs as St,bt as Et,a2 as xt,bu as Rt,bv as Vt,bw as It,v as M,bx as Tt,d as Mt,by as kt,bz as Bt,bA as Dt,a as Nt,ak as Pt,r as jt,bB as $t,bC as Ut,J as At,bD as Ot,B as k,a4 as Ft,bE as zt,bF as Ht,bG as qt,bH as Kt,bI as Gt,bJ as Lt,bK as Wt,bL as Jt,s as Yt,bM as Qt,bN as Xt,bO as Zt,K as ea,bP as ta,bQ as aa,ah as sa,t as na,bR as ra,bS as oa,bT as ia,bU as ca,M as la,bV as da,bW as ua,bX as fa,bY as ma,bZ as pa,b_ as ha,b$ as va,c0 as ba,c1 as ga,c2 as ya,c3 as wa,c4 as _a,G as Ca,c5 as Sa,c6 as Ea,T as xa,N as Ra,c7 as Va,c8 as Ia,c9 as Ta,x as y,ca as Ma,F as ka,cb as Ba,cc as Da,cd as Na,ce as Pa,_ as U,E as ja}from"./index-096889f3.js";import{g as $a}from"./ItemType-548fac8d.js";import{I as A}from"./Item-ae752ac2.js";import{o as O,p as F}from"./VBtn-9acc2f64.js";import{V as Ua}from"./VBreadcrumbs-0b3069eb.js";import{b as Aa,c as Oa,V as P,a as j}from"./VRow-33ca2d49.js";const Fa=()=>{},za=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:X,BaseTransitionPropsValidators:Z,Comment:ee,EffectScope:te,Fragment:$,KeepAlive:ae,ReactiveEffect:se,Static:ne,Suspense:re,Teleport:oe,Text:ie,Transition:ce,TransitionGroup:le,VueElement:de,assertNumber:ue,callWithAsyncErrorHandling:fe,callWithErrorHandling:me,camelize:pe,capitalize:he,cloneVNode:ve,compatUtils:be,compile:Fa,computed:ge,createApp:ye,createBlock:we,createCommentVNode:_e,createElementBlock:I,createElementVNode:Ce,createHydrationRenderer:Se,createPropsRestProxy:Ee,createRenderer:xe,createSSRApp:Re,createSlots:Ve,createStaticVNode:Ie,createTextVNode:T,createVNode:h,customRef:Te,defineAsyncComponent:Me,defineComponent:ke,defineCustomElement:Be,defineEmits:De,defineExpose:Ne,defineModel:Pe,defineOptions:je,defineProps:$e,defineSSRCustomElement:Ue,defineSlots:Ae,get devtools(){return Oe},effect:Fe,effectScope:ze,getCurrentInstance:He,getCurrentScope:qe,getTransitionRawChildren:Ke,guardReactiveProps:Ge,h:Le,handleError:We,hasInjectionContext:Je,hydrate:Ye,initCustomFormatter:Qe,initDirectivesForSSR:Xe,inject:Ze,isMemoSame:et,isProxy:tt,isReactive:at,isReadonly:st,isRef:nt,isRuntimeOnly:rt,isShallow:ot,isVNode:it,markRaw:ct,mergeDefaults:lt,mergeModels:dt,mergeProps:ut,nextTick:ft,normalizeClass:mt,normalizeProps:pt,normalizeStyle:ht,onActivated:vt,onBeforeMount:bt,onBeforeUnmount:gt,onBeforeUpdate:yt,onDeactivated:wt,onErrorCaptured:_t,onMounted:Ct,onRenderTracked:St,onRenderTriggered:Et,onScopeDispose:xt,onServerPrefetch:Rt,onUnmounted:Vt,onUpdated:It,openBlock:M,popScopeId:Tt,provide:Mt,proxyRefs:kt,pushScopeId:Bt,queuePostFlushCb:Dt,reactive:Nt,readonly:Pt,ref:jt,registerRuntimeCompiler:$t,render:Ut,renderList:At,renderSlot:Ot,resolveComponent:k,resolveDirective:Ft,resolveDynamicComponent:zt,resolveFilter:Ht,resolveTransitionHooks:qt,setBlockTracking:Kt,setDevtoolsHook:Gt,setTransitionHooks:Lt,shallowReactive:Wt,shallowReadonly:Jt,shallowRef:Yt,ssrContextKey:Qt,ssrUtils:Xt,stop:Zt,toDisplayString:ea,toHandlerKey:ta,toHandlers:aa,toRaw:sa,toRef:na,toRefs:ra,toValue:oa,transformVNodeArgs:ia,triggerRef:ca,unref:la,useAttrs:da,useCssModule:ua,useCssVars:fa,useModel:ma,useSSRContext:pa,useSlots:ha,useTransitionState:va,vModelCheckbox:ba,vModelDynamic:ga,vModelRadio:ya,vModelSelect:wa,vModelText:_a,vShow:Ca,version:Sa,warn:Ea,watch:xa,watchEffect:Ra,watchPostEffect:Va,watchSyncEffect:Ia,withAsyncContext:Ta,withCtx:y,withDefaults:Ma,withDirectives:ka,withKeys:Ba,withMemo:Da,withModifiers:Na,withScopeId:Pa},Symbol.toStringTag,{value:"Module"}));var Ha=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qa(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Ka(r){if(r.__esModule)return r;var l=r.default;if(typeof l=="function"){var o=function d(){return this instanceof d?Reflect.construct(l,arguments,this.constructor):l.apply(this,arguments)};o.prototype=l.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(r).forEach(function(d){var p=Object.getOwnPropertyDescriptor(r,d);Object.defineProperty(o,d,p.get?p:{enumerable:!0,get:function(){return r[d]}})}),o}var z={exports:{}};const Ga=Ka(za);(function(r,l){(function(o,d){r.exports=d(Ga)})(Ha,function(o){/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation.

	    Permission to use, copy, modify, and/or distribute this software for any
	    purpose with or without fee is hereby granted.

	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	    PERFORMANCE OF THIS SOFTWARE.
	    ***************************************************************************** */function d(c,b,n,i){function s(e){return e instanceof n?e:new n(function(f){f(e)})}return new(n||(n=Promise))(function(e,f){function w(m){try{t(i.next(m))}catch(S){f(S)}}function C(m){try{t(i.throw(m))}catch(S){f(S)}}function t(m){m.done?e(m.value):s(m.value).then(w,C)}t((i=i.apply(c,b||[])).next())})}function p(c,b){var n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,s,e,f;return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(t){return function(m){return C([t,m])}}function C(t){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,s&&(e=t[0]&2?s.return:t[0]?s.throw||((e=s.return)&&e.call(s),0):s.next)&&!(e=e.call(s,t[1])).done)return e;switch(s=0,e&&(t=[t[0]&2,e.value]),t[0]){case 0:case 1:e=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,s=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(e=n.trys,!(e=e.length>0&&e[e.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){n.label=t[1];break}if(t[0]===6&&n.label<e[1]){n.label=e[1],e=t;break}if(e&&n.label<e[2]){n.label=e[2],n.ops.push(t);break}e[2]&&n.ops.pop(),n.trys.pop();continue}t=b.call(c,n)}catch(m){t=[6,m],s=0}finally{i=e=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}var v=o.defineComponent({name:"Camera",components:{},emits:["loading","started","stopped","paused","resumed","camera-change","snapshot","error"],props:{resolution:{type:Object,default:function(){return{width:1920,height:1080}}},facingMode:{type:String,default:"environment"},autoplay:{type:Boolean,default:!0},playsinline:{type:Boolean,default:!0},constraints:{type:Object,required:!1}},setup:function(c,b){var n=this,i=b.emit;o.onMounted(function(){if(!navigator.mediaDevices)throw new Error("Media devices not available");var a=document.getElementById("video");c.playsinline&&a&&a.setAttribute("playsinline",""),c.autoplay&&m()}),o.onUnmounted(function(){return R()});var s=o.ref(),e=o.ref(),f=o.ref(),w=c.constraints||{video:{width:c.resolution.width,height:c.resolution.height,facingMode:c.facingMode,deviceId:{}},audio:!1},C=function(a){return a===void 0&&(a=["audioinput","videoinput"]),d(n,void 0,void 0,function(){var u;return p(this,function(g){switch(g.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:return u=g.sent(),[2,u.filter(function(E){return a.includes(E.kind)})]}})})},t=function(){if(f.value){var a=f.value.getVideoTracks().map(function(u){return u.getSettings().deviceId});if(a.length>0)return a[0]}},m=function(){return d(n,void 0,void 0,function(){var a,u;return p(this,function(g){switch(g.label){case 0:i("loading"),g.label=1;case 1:return g.trys.push([1,3,,4]),a=f,[4,navigator.mediaDevices.getUserMedia(w)];case 2:if(a.value=g.sent(),!s.value)throw new Error("Video ref is null");return s.value.srcObject=f.value,i("started"),[3,4];case 3:return u=g.sent(),i("error",u),[3,4];case 4:return[2]}})})},S=function(a,u,g){var E;if(a===void 0&&(a=c.resolution),u===void 0&&(u="image/png"),!s.value)throw new Error("Video ref is null");if(!e.value)throw new Error("Canvas ref is null");var B=a.width,D=a.height;return e.value.width=B,e.value.height=D,(E=e.value.getContext("2d"))===null||E===void 0||E.drawImage(s.value,0,0,B,D),new Promise(function(Q){var V;(V=e.value)===null||V===void 0||V.toBlob(function(N){i("snapshot",N),Q(N)},u,g)})},W=function(a){return d(n,void 0,void 0,function(){return p(this,function(u){switch(u.label){case 0:return R(),w.video.deviceId.exact=a,[4,m()];case 1:return u.sent(),i("camera-change",a),[2]}})})},J=function(){var a;(a=s.value)===null||a===void 0||a.play(),i("resumed")},Y=function(){var a;(a=s.value)===null||a===void 0||a.pause(),i("paused")},R=function(){var a;(a=f.value)===null||a===void 0||a.getTracks().forEach(function(u){return u.stop()}),i("stopped")};return{start:m,stop:R,video:s,snapshot:S,canvas:e,devices:C,currentDeviceID:t,pause:Y,resume:J,changeCamera:W,stream:f}}});const _={id:"camera-container"},x={autoplay:"",ref:"video",id:"video"},H={id:"slot-container"},q={ref:"canvas",id:"canvas"};function K(c,b,n,i,s,e){return o.openBlock(),o.createElementBlock(o.Fragment,null,[o.createElementVNode("div",_,[o.createElementVNode("video",x,null,512),o.createElementVNode("div",H,[o.renderSlot(c.$slots,"default")])]),o.createElementVNode("canvas",q,null,512)],64)}function G(c,b){b===void 0&&(b={});var n=b.insertAt;if(!(!c||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=c:s.appendChild(document.createTextNode(c))}}var L=`
#camera-container[data-v-74104ed5] {
    position: relative;
    width: 100%;
    height: 100%;
}
#slot-container[data-v-74104ed5] {
    position: absolute;
    height: 100%;
    width: 100%;
    left: 0;
    top: 0;
}
#video[data-v-74104ed5] {
    width: 100%;
    height: 100%;
}
#canvas[data-v-74104ed5] {
    display: none;
}
`;return G(L),v.render=K,v.__scopeId="data-v-74104ed5",v.__file="src/components/Camera.vue",v})})(z);var La=z.exports;const Wa=qa(La),Ja={props:{idUser:{type:Number,required:!0},idItem:{type:Number,required:!0}},components:{"simple-v-camera":Wa},methods:{async snapshot(){const r=this.idUser,l=this.idItem,o=this.$refs;if(o){const d=o.camera;if(d){const p=await d.snapshot(),v=new FormData;v.append("image",p,"snapshot.jpg"),v.append("iduser",r.toString()),v.append("iditem",l.toString()),await A.uploadImage(v),this.$router.push({name:"Item",params:{id:l}})}}}}};function Ya(r,l,o,d,p,v){const _=k("simple-v-camera");return M(),I("div",null,[h(_,{resolution:{width:400,height:400},ref:"camera",autoplay:""},null,512),h(O,{onClick:l[0]||(l[0]=x=>v.snapshot()),class:"bg-amber mt-2"},{default:y(()=>[h(F,{icon:"mdi-camera",size:"large",start:""}),T(" Tomar Foto ")]),_:1})])}const Qa=U(Ja,[["render",Ya]]),Xa={components:{Photo:Qa},data(){var r;return{breadcrumb:[],id:parseInt(this.$route.params.id+""),idUser:parseInt(((r=ja())==null?void 0:r.id)+""),item:{},title:"",collection:{},loading:!1,typeLabel:l=>$a(l)}},methods:{async fetchItem(){this.loading=!0;try{const r=await A.fetch(this.idUser,this.id,null);this.item=r[0]}catch(r){console.error(r)}finally{this.loading=!1}}},async mounted(){await this.fetchItem(),this.breadcrumb=["Colecciones",this.item.collectionname+"",this.item.title,"Foto"],this.item.iditemtype===3?this.title=this.item.title+" - "+this.item.author:this.title=this.item.title}};function Za(r,l,o,d,p,v){const _=k("Photo");return M(),I($,null,[h(Ua,{items:p.breadcrumb},null,8,["items"]),h(Aa,null,{default:y(()=>[h(Oa,{class:"text-center"},{default:y(()=>[h(P,{justify:"center"},{default:y(()=>[h(j,{cols:"auto"},{default:y(()=>[h(_,{"id-user":p.idUser,"id-item":p.id},null,8,["id-user","id-item"])]),_:1})]),_:1}),h(P,{justify:"center"},{default:y(()=>[h(j,{cols:"auto"},{default:y(()=>[h(O,{onClick:l[0]||(l[0]=x=>r.$router.push({name:"Item",params:{id:p.id}})),class:"bg-gray mt-2"},{default:y(()=>[h(F,{icon:"mdi-cancel",size:"large",start:""}),T(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}const os=U(Xa,[["render",Za]]);export{os as default};
