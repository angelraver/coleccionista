import{as as ae,at as ne,au as se,av as re,F as $,aw as oe,ax as ie,ay as ce,az as le,ar as de,aA as ue,al as fe,aB as me,aC as pe,aD as he,aE as ve,aF as be,aG as ge,aH as ye,aI as we,aJ as _e,c as Ce,aK as Se,C as B,H as V,w as I,z as F,aL as Ee,aM as xe,aN as Re,aO as Ve,aP as Ie,aQ as Te,y as D,q as h,aR as ke,aS as Me,A as Be,aT as De,aU as Ne,aV as Pe,aW as je,aX as Ue,aY as Ae,aZ as Oe,a_ as $e,a$ as Fe,b0 as ze,ap as He,b1 as Le,b2 as qe,b3 as Ke,b4 as Ge,b5 as We,b6 as Je,b7 as Ye,b8 as Qe,b9 as Xe,ba as Ze,i as et,bb as tt,bc as at,bd as nt,be as st,bf as rt,bg as ot,bh as it,bi as ct,bj as lt,bk as dt,bl as ut,U as ft,Y as mt,bm as pt,bn as ht,bo as vt,j as bt,bp as gt,k as yt,bq as wt,h as _t,br as Ct,o as St,bs as Et,bt as xt,a2 as Rt,bu as Vt,bv as It,bw as Tt,v as _,bx as kt,d as Mt,by as Bt,bz as Dt,bA as Nt,a as Pt,ak as jt,r as Ut,bB as At,bC as Ot,K as $t,bD as Ft,B as T,a4 as zt,bE as Ht,bF as Lt,bG as qt,bH as Kt,bI as Gt,bJ as Wt,bK as Jt,bL as Yt,s as Qt,bM as Xt,bN as Zt,bO as ea,L as z,bP as ta,bQ as aa,ah as na,t as sa,bR as ra,bS as oa,bT as ia,bU as ca,M as la,bV as da,bW as ua,bX as fa,bY as ma,bZ as pa,b_ as ha,b$ as va,c0 as ba,c1 as ga,c2 as ya,c3 as wa,c4 as _a,J as Ca,c5 as Sa,c6 as Ea,T as xa,N as Ra,c7 as Va,c8 as Ia,c9 as Ta,x as y,ca as ka,I as Ma,cb as Ba,cc as Da,cd as Na,ce as Pa,_ as H,G as ja}from"./index-ec70cf82.js";import{I as L}from"./Item-470b7969.js";import{o as q,p as K}from"./VBtn-16eb0950.js";import{L as Ua}from"./Loading-88873d3a.js";import{V as Aa}from"./VBreadcrumbs-58fd7af5.js";import{b as Oa,c as $a,V as A,a as O}from"./VResponsive-e0b54abe.js";const Fa=()=>{},za=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:ae,BaseTransitionPropsValidators:ne,Comment:se,EffectScope:re,Fragment:$,KeepAlive:oe,ReactiveEffect:ie,Static:ce,Suspense:le,Teleport:de,Text:ue,Transition:fe,TransitionGroup:me,VueElement:pe,assertNumber:he,callWithAsyncErrorHandling:ve,callWithErrorHandling:be,camelize:ge,capitalize:ye,cloneVNode:we,compatUtils:_e,compile:Fa,computed:Ce,createApp:Se,createBlock:B,createCommentVNode:V,createElementBlock:I,createElementVNode:F,createHydrationRenderer:Ee,createPropsRestProxy:xe,createRenderer:Re,createSSRApp:Ve,createSlots:Ie,createStaticVNode:Te,createTextVNode:D,createVNode:h,customRef:ke,defineAsyncComponent:Me,defineComponent:Be,defineCustomElement:De,defineEmits:Ne,defineExpose:Pe,defineModel:je,defineOptions:Ue,defineProps:Ae,defineSSRCustomElement:Oe,defineSlots:$e,get devtools(){return Fe},effect:ze,effectScope:He,getCurrentInstance:Le,getCurrentScope:qe,getTransitionRawChildren:Ke,guardReactiveProps:Ge,h:We,handleError:Je,hasInjectionContext:Ye,hydrate:Qe,initCustomFormatter:Xe,initDirectivesForSSR:Ze,inject:et,isMemoSame:tt,isProxy:at,isReactive:nt,isReadonly:st,isRef:rt,isRuntimeOnly:ot,isShallow:it,isVNode:ct,markRaw:lt,mergeDefaults:dt,mergeModels:ut,mergeProps:ft,nextTick:mt,normalizeClass:pt,normalizeProps:ht,normalizeStyle:vt,onActivated:bt,onBeforeMount:gt,onBeforeUnmount:yt,onBeforeUpdate:wt,onDeactivated:_t,onErrorCaptured:Ct,onMounted:St,onRenderTracked:Et,onRenderTriggered:xt,onScopeDispose:Rt,onServerPrefetch:Vt,onUnmounted:It,onUpdated:Tt,openBlock:_,popScopeId:kt,provide:Mt,proxyRefs:Bt,pushScopeId:Dt,queuePostFlushCb:Nt,reactive:Pt,readonly:jt,ref:Ut,registerRuntimeCompiler:At,render:Ot,renderList:$t,renderSlot:Ft,resolveComponent:T,resolveDirective:zt,resolveDynamicComponent:Ht,resolveFilter:Lt,resolveTransitionHooks:qt,setBlockTracking:Kt,setDevtoolsHook:Gt,setTransitionHooks:Wt,shallowReactive:Jt,shallowReadonly:Yt,shallowRef:Qt,ssrContextKey:Xt,ssrUtils:Zt,stop:ea,toDisplayString:z,toHandlerKey:ta,toHandlers:aa,toRaw:na,toRef:sa,toRefs:ra,toValue:oa,transformVNodeArgs:ia,triggerRef:ca,unref:la,useAttrs:da,useCssModule:ua,useCssVars:fa,useModel:ma,useSSRContext:pa,useSlots:ha,useTransitionState:va,vModelCheckbox:ba,vModelDynamic:ga,vModelRadio:ya,vModelSelect:wa,vModelText:_a,vShow:Ca,version:Sa,warn:Ea,watch:xa,watchEffect:Ra,watchPostEffect:Va,watchSyncEffect:Ia,withAsyncContext:Ta,withCtx:y,withDefaults:ka,withDirectives:Ma,withKeys:Ba,withMemo:Da,withModifiers:Na,withScopeId:Pa},Symbol.toStringTag,{value:"Module"}));var Ha=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function La(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function qa(r){if(r.__esModule)return r;var p=r.default;if(typeof p=="function"){var o=function d(){return this instanceof d?Reflect.construct(p,arguments,this.constructor):p.apply(this,arguments)};o.prototype=p.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(r).forEach(function(d){var c=Object.getOwnPropertyDescriptor(r,d);Object.defineProperty(o,d,c.get?c:{enumerable:!0,get:function(){return r[d]}})}),o}var G={exports:{}};const Ka=qa(za);(function(r,p){(function(o,d){r.exports=d(Ka)})(Ha,function(o){/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation.

	    Permission to use, copy, modify, and/or distribute this software for any
	    purpose with or without fee is hereby granted.

	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	    PERFORMANCE OF THIS SOFTWARE.
	    ***************************************************************************** */function d(l,b,s,i){function n(e){return e instanceof s?e:new s(function(f){f(e)})}return new(s||(s=Promise))(function(e,f){function w(m){try{t(i.next(m))}catch(E){f(E)}}function S(m){try{t(i.throw(m))}catch(E){f(E)}}function t(m){m.done?e(m.value):n(m.value).then(w,S)}t((i=i.apply(l,b||[])).next())})}function c(l,b){var s={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,f;return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(t){return function(m){return S([t,m])}}function S(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(e=t[0]&2?n.return:t[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,t[1])).done)return e;switch(n=0,e&&(t=[t[0]&2,e.value]),t[0]){case 0:case 1:e=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,n=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(e=s.trys,!(e=e.length>0&&e[e.length-1])&&(t[0]===6||t[0]===2)){s=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){s.label=t[1];break}if(t[0]===6&&s.label<e[1]){s.label=e[1],e=t;break}if(e&&s.label<e[2]){s.label=e[2],s.ops.push(t);break}e[2]&&s.ops.pop(),s.trys.pop();continue}t=b.call(l,s)}catch(m){t=[6,m],n=0}finally{i=e=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}var v=o.defineComponent({name:"Camera",components:{},emits:["loading","started","stopped","paused","resumed","camera-change","snapshot","error"],props:{resolution:{type:Object,default:function(){return{width:1920,height:1080}}},facingMode:{type:String,default:"environment"},autoplay:{type:Boolean,default:!0},playsinline:{type:Boolean,default:!0},constraints:{type:Object,required:!1}},setup:function(l,b){var s=this,i=b.emit;o.onMounted(function(){if(!navigator.mediaDevices)throw new Error("Media devices not available");var a=document.getElementById("video");l.playsinline&&a&&a.setAttribute("playsinline",""),l.autoplay&&m()}),o.onUnmounted(function(){return k()});var n=o.ref(),e=o.ref(),f=o.ref(),w=l.constraints||{video:{width:l.resolution.width,height:l.resolution.height,facingMode:l.facingMode,deviceId:{}},audio:!1},S=function(a){return a===void 0&&(a=["audioinput","videoinput"]),d(s,void 0,void 0,function(){var u;return c(this,function(g){switch(g.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:return u=g.sent(),[2,u.filter(function(x){return a.includes(x.kind)})]}})})},t=function(){if(f.value){var a=f.value.getVideoTracks().map(function(u){return u.getSettings().deviceId});if(a.length>0)return a[0]}},m=function(){return d(s,void 0,void 0,function(){var a,u;return c(this,function(g){switch(g.label){case 0:i("loading"),g.label=1;case 1:return g.trys.push([1,3,,4]),a=f,[4,navigator.mediaDevices.getUserMedia(w)];case 2:if(a.value=g.sent(),!n.value)throw new Error("Video ref is null");return n.value.srcObject=f.value,i("started"),[3,4];case 3:return u=g.sent(),i("error",u),[3,4];case 4:return[2]}})})},E=function(a,u,g){var x;if(a===void 0&&(a=l.resolution),u===void 0&&(u="image/png"),!n.value)throw new Error("Video ref is null");if(!e.value)throw new Error("Canvas ref is null");var P=a.width,j=a.height;return e.value.width=P,e.value.height=j,(x=e.value.getContext("2d"))===null||x===void 0||x.drawImage(n.value,0,0,P,j),new Promise(function(te){var M;(M=e.value)===null||M===void 0||M.toBlob(function(U){i("snapshot",U),te(U)},u,g)})},X=function(a){return d(s,void 0,void 0,function(){return c(this,function(u){switch(u.label){case 0:return k(),w.video.deviceId.exact=a,[4,m()];case 1:return u.sent(),i("camera-change",a),[2]}})})},Z=function(){var a;(a=n.value)===null||a===void 0||a.play(),i("resumed")},ee=function(){var a;(a=n.value)===null||a===void 0||a.pause(),i("paused")},k=function(){var a;(a=f.value)===null||a===void 0||a.getTracks().forEach(function(u){return u.stop()}),i("stopped")};return{start:m,stop:k,video:n,snapshot:E,canvas:e,devices:S,currentDeviceID:t,pause:ee,resume:Z,changeCamera:X,stream:f}}});const C={id:"camera-container"},R={autoplay:"",ref:"video",id:"video"},N={id:"slot-container"},W={ref:"canvas",id:"canvas"};function J(l,b,s,i,n,e){return o.openBlock(),o.createElementBlock(o.Fragment,null,[o.createElementVNode("div",C,[o.createElementVNode("video",R,null,512),o.createElementVNode("div",N,[o.renderSlot(l.$slots,"default")])]),o.createElementVNode("canvas",W,null,512)],64)}function Y(l,b){b===void 0&&(b={});var s=b.insertAt;if(!(!l||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",s==="top"&&i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=l:n.appendChild(document.createTextNode(l))}}var Q=`
#camera-container[data-v-74104ed5] {
    position: relative;
    width: 100%;
    height: 100%;
}
#slot-container[data-v-74104ed5] {
    position: absolute;
    height: 100%;
    width: 100%;
    left: 0;
    top: 0;
}
#video[data-v-74104ed5] {
    width: 100%;
    height: 100%;
}
#canvas[data-v-74104ed5] {
    display: none;
}
`;return Y(Q),v.render=J,v.__scopeId="data-v-74104ed5",v.__file="src/components/Camera.vue",v})})(G);var Ga=G.exports;const Wa=La(Ga),Ja={props:{idUser:{type:Number,required:!0},idItem:{type:Number,required:!0}},components:{"simple-v-camera":Wa},data(){return{loading:!1}},methods:{async snapshot(){this.loading=!0;const r=this.idUser,p=this.idItem,o=this.$refs;if(o){const d=o.camera;if(d){const c=await d.snapshot(),v=new FormData;v.append("image",c,"snapshot.jpg"),v.append("iduser",r.toString()),v.append("iditem",p.toString()),await L.uploadImage(v),this.$router.push({name:"Item",params:{id:p}})}}}}};function Ya(r,p,o,d,c,v){const C=T("simple-v-camera");return _(),I("div",null,[h(C,{resolution:{width:400,height:400},ref:"camera",autoplay:""},null,512),c.loading?V("",!0):(_(),B(q,{key:0,onClick:p[0]||(p[0]=R=>v.snapshot()),class:"bg-amber mt-2"},{default:y(()=>[h(K,{icon:"mdi-camera",size:"large",start:""}),D(" Tomar Foto ")]),_:1}))])}const Qa=H(Ja,[["render",Ya]]),Xa={components:{Photo:Qa,Loading:Ua},data(){var r;return{breadcrumbs:[],id:parseInt(this.$route.params.id+""),idUser:parseInt(((r=ja())==null?void 0:r.id)+""),item:{},title:"",loading:!1}},methods:{async fetchItem(){this.loading=!0;try{const r=await L.fetch(this.idUser,this.id,null);this.item=r[0]}catch(r){console.error(r)}finally{this.loading=!1}}},async mounted(){await this.fetchItem(),this.title=this.item.title,this.breadcrumbs=[{title:"Colecciones",href:"/home"},{title:this.item.collectionname+"",href:"/collection/"+this.item.idcollection},{title:this.item.title,href:"/item/"+this.item.id},{title:"Editar",href:"/item/edit/"+this.item.id},{title:"Foto"}]}},Za={key:1};function en(r,p,o,d,c,v){const C=T("Loading"),R=T("Photo");return _(),I($,null,[c.loading?(_(),B(C,{key:0})):V("",!0),c.loading?V("",!0):(_(),I("div",Za,[h(Aa,{items:c.breadcrumbs},null,8,["items"]),h(Oa,null,{default:y(()=>[h($a,{class:"text-center"},{default:y(()=>[h(A,{justify:"center"},{default:y(()=>[h(O,{cols:"auto"},{default:y(()=>[F("h1",null,"Tomar foto para "+z(c.title),1),h(R,{"id-user":c.idUser,"id-item":c.id},null,8,["id-user","id-item"])]),_:1})]),_:1}),h(A,{justify:"center"},{default:y(()=>[h(O,{cols:"auto"},{default:y(()=>[h(q,{onClick:p[0]||(p[0]=N=>r.$router.push({name:"Item",params:{id:c.id}})),class:"bg-gray mt-2"},{default:y(()=>[h(K,{icon:"mdi-cancel",size:"large",start:""}),D(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))],64)}const cn=H(Xa,[["render",en]]);export{cn as default};
